---
title: "Cleaning Test cricketer data"
author: "Kevin Wang"
date: "16/08/2019"
output:
  html_document:
    code_folding: hide
    fig_height: 10
    fig_width: 10
    toc: yes
    number_sections: true
    toc_depth: 3
    toc_float: yes
editor_options: 
  chunk_output_type: console
---

# Introduction

In this document, we will visualise the cleaned cricket

```{r}
library(tidyverse)
library(mcvis)
```


# Loading data
```{r}
clean_test_batting_career = readr::read_csv("./clean_test_batting_career.csv")

clean_test_batting_inngings = readr::read_csv("./clean_test_batting_inngings.csv")
```

# Correlation betwen key numeric variables

Looking at the correlation plot, it is not clear as to which variable is the main culprit that causes multi-collinearity. 

## Corrplot
```{r}
X = clean_test_batting_career %>% 
  dplyr::select_if(is.numeric) %>% 
  na.omit() %>% 
  dplyr::mutate(log_runs = log10(runs + 1L),
                log_bf = log10(balls_faced)) %>% 
  dplyr::select(-career_start, -career_end, -ave, -mat, -runs, -balls_faced)

glimpse(X)

skimr::skim(X)

corrplot::corrplot.mixed(
  cor(X), 
  upper = "square")
```

## d3heatmap
```{r}
d3heatmap::d3heatmap(cor(X))
```


# mcvis


mcvis method seems to point to the `runs` variable as the main cause of colinearity.

```{r}
mcvis_result = X %>% 
  mcvis::mcvis()

mcvis_result$MC %>% round(2)

mcvis::ggplot_mcvis(mcvis_result)
```


# Session Info
```{r}
sessionInfo()
```

